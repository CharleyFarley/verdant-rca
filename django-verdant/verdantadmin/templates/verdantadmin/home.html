{% extends "verdantadmin/base.html" %}

{% block bodyclass %}homepage{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{{ STATIC_URL }}verdantadmin/css/layouts/home.less" type="text/less" />
{% endblock %}

{% block content %}
    <header class="merged">
        <h1>Welcome to the Verdant CMS for {{ site_name }}</h1>
    </header>


    <section class="summary">
        <h2>Site summary</h2>
        <ul>
            <li class="icon icon-doc-empty-inverse"><span>{{ total_pages }}</span> Page{{ total_pages|pluralize:"s" }}</li>
            <li class="icon icon-image"><span>{{ total_images }}</span> Image{{ total_images|pluralize:"s" }}</li>
            <li class="icon icon-doc-full-inverse"><span>{{ total_docs }}</span> Document{{ total_docs|pluralize:"s" }}</li>
        </ul>
    </section>

    {% if page_revisions_for_moderation %}
        <div class="nice-padding">
            <h2>Pages awaiting moderation</h2>
            <table class="listing">
                <col />
                <col width="15%"/>
                <col width="15%"/>
                <col width="30%"/>
                <thead>
                    <tr>
                        <th class="title">Title</th>
                        <th>Submitted by</th>
                        <th>Submission date</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for revision in page_revisions_for_moderation %}
                        <tr>
                            <td class="title">
                                <h2><a href="{% url 'verdantadmin_pages_edit' revision.page.id %}" title="Edit this page">{{ revision.page.title }}</a></h2>
                                <ul class="actions">
                                    <li><a href="{% url 'verdantadmin_pages_preview_for_moderation' revision.id %}">Preview</a></li>
                                </ul>
                            </td>
                            <td>{{ revision.user.get_full_name }}</td>
                            <td>{{ revision.created_at|date:"d M Y H:i" }}</td>
                            <td class="moderate-actions">                
                                <form action="{% url 'verdantadmin_pages_approve_moderation' revision.id %}" method="POST">
                                    {% csrf_token %}
                                    <input type="submit" class="button button-small" value="Approve">
                                </form>

                                <form action="{% url 'verdantadmin_pages_reject_moderation' revision.id %}" method="POST">
                                    {% csrf_token %}
                                    <input type="submit" class="button button-small no" value="Reject">
                                </form>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}
{% endblock %}
