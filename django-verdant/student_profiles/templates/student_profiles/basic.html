{% extends "student_profiles/edit_base.html" %}
{% load static compress %}


{% block form_content %}

<h1>Basic profile</h1>

<form method="POST" accept-charset="utf-8" enctype="multipart/form-data">{% csrf_token %}

  {% include 'student_profiles/form_snippet.html' with form=basic_form %}

  <hr>
  {% include "student_profiles/formset_single_field.html" with formset=email_formset %}
  <hr>

  {% include "student_profiles/formset_single_field.html" with formset=phone_formset %}
  {% include "student_profiles/formset_single_field.html" with formset=website_formset %}

  <p><input type="submit" class="profile-save" value="Save"></p>
</form>

{% endblock form_content %}


{% block form_js %}
<script src="{% static "student_profiles/js/image_handler.js" %}"></script>
<script type="text/javascript">
$(function() {
  var emailTotalFormsElement = $('#id_{{ email_formset.prefix }}-TOTAL_FORMS');
  $('#{{ email_formset.prefix }} .inline-form').formset({
      prefix: '{{ email_formset.prefix }}',
      formCssClass: 'dynamic-formset-{{ email_formset.prefix }}',
    added: function(row) {
      row.find('input.order-value').val(emailTotalFormsElement.val());
    }
  });
  $('#{{ phone_formset.prefix }} .inline-form').formset({
      prefix: '{{ phone_formset.prefix }}',
      formCssClass: 'dynamic-formset-{{ phone_formset.prefix }}'
  });
  $('#{{ website_formset.prefix }} .inline-form').formset({
      prefix: '{{ website_formset.prefix }}',
      formCssClass: 'dynamic-formset-{{ website_formset.prefix }}'
  });
  makeRichTextEditable('id_statement');
  activateImageUpload('profile_image');
})
</script>
{% endblock form_js %}

