{% extends "student_profiles/now_edit_base.html" %}
{% load static compress %}

{% block title %}RCA Now pages{% endblock title %}


{% block content %}

<div class="session-meta">
    <span>Hello, {{ user.username }}</span>
    <a href="/admin/logout/">Log out</a>
</div>

    <nav class="student-profile-nav"></nav>

{% if messages %}
<ul class="messages">
    {% for message in messages %}
    <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
    {% endfor %}
</ul>
{% endif %}


<div class="page-content rca-now">
  {% if messages %}
  <ul class="messages">
      {% for message in messages %}
      <li{% if message.tags %} class="{{ message.tags }}"{% endif %}>{{ message }}</li>
      {% endfor %}
  </ul>
  {% endif %}
  <h1>Your RCA Now blog</h1>
  <section class="row">
    <section class="body-text">
      {% if not pages %}
      <div>
        You have no posts yet, time to <a href="{% url 'nowpages:create' %}">get writing</a>. 
      </div>
      {% else %}
      <table>
        <tr>
          <th>Page title</th>
          <th>Status</th>
          <th></th>
        </tr>
        {% for page in pages %}
          <tr>
            <td>{{ page.title }}</td>
            <td>{% if page.live %}LIVE {% if page.has_unpublished_changes %} + Draft{% endif %}
              {% else %}
              Draft{% endif %}
              {% if page.waiting_for_moderation %}<br>Waiting for publication{% endif %}
            <td>
              {% if page.live %}<a href="{{ page.url }}">Show live page</a><br>{% endif %}
              {% if page.has_unpublished_changes %}<a href="{% url 'nowpages:preview' page.id %}">Show preview of your post</a>{% endif %}
            </td>
            <td><a href="{% url 'nowpages:edit' page.id %}" class="button">edit</a></td>
            <td>{% if page.has_unpublished_changes %}
              <form action="{% url 'nowpages:submit' page.id %}" method="POST">{% csrf_token %}
                <input type="submit" class="submit-page" value="Submit for publication">
              </form>
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </table>
      {% endif %}
    </section>
    <section class="notes">
      <h3>Notes</h3>
      <p> Create, edit and submit your blog posts for moderation. </p>
      <p> Get your best works out there for all to enjoy, RCA now. </p>
    </section>
  </section>
</div>

{% endblock %}

{% block extra_css %}
    {% include "wagtailadmin/pages/_editor_css.html" %}
    {% compress css %}<link rel="stylesheet" type="text/less" href="{% static "rca/css/student-profiles.less" %}" />{% endcompress %}
    <link rel="stylesheet" type="text/less" href="http://code.ionicframework.com/ionicons/2.0.0/css/ionicons.min.css" />
{% endblock %}