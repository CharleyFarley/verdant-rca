{% extends 'rca_show/base.html' %}
{% load show_tags rich_text pageurl %}

{% block body_class %}{{ block.super }} type-school school-{{ school }}{% endblock %}

{% block content %}
    {% secondary_menu self.show_index as menuitems %}

    {% get_school_programmes self.show_index school as programmes %}
    {% get_school_students self.show_index school as students %}
    {% get_school_students self.show_index school random=True as rand_students %}
    {% get_schools self.show_index as schools %}

    {% with menuitems.all as items %}  
    {% if items|length >= 3 %}
        <section class="shownav four-items">
    {% else %}
        <section class="shownav">
    {% endif %}
    {% endwith %}
        <ul class="nav-overview">
            <li><a href="{% show_subpage_url self.show_index 'school_index' %}">Schools &amp; Students</a></li>
            {% for item in menuitems %}
                <li {% if item.url == self.url %}class="active"{% endif %}>
                    <a href="{% pageurl item %}">{{ item.title }}</a>
                </li>
            {% endfor %}
        </ul>
        <ul>
            {% if schools %}
                <li class="jumplist active">
                    <h2 class="toggle">Select a School</h2>
                    <div class="selected toggle">{% get_school_display school %}</div>
                    <ul class="options">
                        {% for school in schools %}
                            <li><a href="{% show_subpage_url self.show_index 'school' school=school %}">{% get_school_display school %}</a></li>
                        {% endfor %}
                    </ul>
                </li>
            {% endif %}
            <li class="jumplist">
                <h2 class="toggle">Select a Programme</h2>
                <div class="selected toggle"></div>
                <ul class="options">
                    {% for programme in programmes %}
                        <li><a href="{% show_subpage_url self.show_index 'programme' school=school programme=programme %}">{% get_programme_display programme %}</a></li>
                    {% endfor %}
                </ul>
            </li>
            <li class="jumplist">
                <h2 class="toggle">Select a Student</h2>
                <div class="selected toggle"></div>
                <ul class="options">
                    {% for student in students %}
                        <li><a href="{% show_subpage_url self.show_index 'student' school=student.school programme=student.programme slug=student.slug %}">{{ student.title }}</a></li>
                    {% endfor %}
                </ul>
            </li>
        </ul>
    </section>

    <h1>{% get_school_display school %}</h1>

    {{ intro|safe }}

    <div class="shownav programme-list">
        <ul>
            {% for programme in programmes %}
                <li><a href="{% show_subpage_url self.show_index 'programme' school=school programme=programme %}">{% get_programme_display programme %}</a></li>
            {% endfor %}
        </ul>
    </div>

    {% include "rca_show/includes/modules/gallery.html" with students=rand_students %}
   
{% endblock %}

{% block sidebar %}
    {% include "rca/includes/sidebar.html" with showToday="true" %}
{% endblock %}